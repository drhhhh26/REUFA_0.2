# ×”×’×“×¨×ª ××¢×¨×›×ª ××‘×—× ×™× ×“×™× ××™×ª - Google Sheets + Apps Script

××“×¨×™×š ×–×” ××¡×‘×™×¨ ×›×™×¦×“ ×œ×”×’×“×™×¨ ××ª ××¢×¨×›×ª ×”××‘×—× ×™× ×›×š ×©×”×™× ×ª×‘×—×¨ ×©××œ×•×ª ×‘××•×¤×Ÿ ×“×™× ××™ ×œ×¤×™ × ×•×©× (×˜×¨××•××”/×—×™×œ×•×¥) ×•×¨××ª ×§×•×©×™ (Easy/Medium/Hard).

---

## ğŸ“Š ×©×œ×‘ 1: ×™×¦×™×¨×ª Google Sheet ×¢× 2 ×’×œ×™×•× ×•×ª

### 1.1 ×¦×•×¨ Google Sheet ×—×“×©
- ×§×¨× ×œ×•: **"×××’×¨ ×©××œ×•×ª - ××“×•×¨ ×¨×¤×•××”"**
- ×–×” ×™×”×™×” ×”×§×•×‘×¥ ×”××¨×›×–×™ ×œ×›×œ ×”××‘×—× ×™×

### 1.2 ×¦×•×¨ 2 ×’×œ×™×•× ×•×ª (Sheets)
1. **×’×œ×™×•×Ÿ ×¨××©×•×Ÿ:** ×©× ×” ××ª ×”×©× ×œ-`exam_hovesh_1`
   - ××›×™×œ ×©××œ×•×ª ×œ××‘×—×Ÿ ×¤×ª×™×—×” (×—×•×‘×© + ××˜"×‘)

2. **×’×œ×™×•×Ÿ ×©× ×™:** ×”×•×¡×£ ×’×œ×™×•×Ÿ ×—×“×© ×•×§×¨× ×œ×• `exam_metav_1`
   - ××›×™×œ ×©××œ×•×ª ×œ××‘×—×Ÿ ×¡×™×•× (×—×•×‘×© + ××˜"×‘)

**âš ï¸ ×—×©×•×‘:** ×”×©××•×ª ×—×™×™×‘×™× ×œ×”×™×•×ª **×‘×“×™×•×§** ×›××• ×œ××¢×œ×”!

---

## ğŸ“ ×©×œ×‘ 2: ××‘× ×” ×”×¢××•×“×•×ª

×‘×›×œ ××—×“ ××”×’×œ×™×•× ×•×ª, ×”×•×¡×£ ××ª ×”×¢××•×“×•×ª ×”×‘××•×ª (×©×•×¨×” 1 = ×›×•×ª×¨×•×ª):

| A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|
| question | answer1 | answer2 | answer3 | answer4 | correct | topic | difficulty |

### ×”×¡×‘×¨ ×¢×œ ×”×¢××•×“×•×ª:

- **question** - ×˜×§×¡×˜ ×”×©××œ×”
- **answer1-4** - 4 ×ª×©×•×‘×•×ª ××¤×©×¨×™×•×ª
- **correct** - ××¡×¤×¨ ×”×ª×©×•×‘×” ×”× ×›×•× ×” (1, 2, 3, ××• 4)
- **topic** - × ×•×©× ×”×©××œ×”:
  - `trauma` (×˜×¨××•××”)
  - `rescue` (×—×™×œ×•×¥)
- **difficulty** - ×¨××ª ×§×•×©×™:
  - `Easy` (×§×œ)
  - `Medium` (×‘×™× ×•× ×™)
  - `Hard` (×§×©×”)

---

## ğŸ¯ ×©×œ×‘ 3: ×”×•×¡×¤×ª ×©××œ×•×ª ×œ×“×•×’××”

### ×“×•×’××” ×œ×’×œ×™×•×Ÿ `exam_hovesh_1`:

| question | answer1 | answer2 | answer3 | answer4 | correct | topic | difficulty |
|----------|---------|---------|---------|---------|---------|-------|------------|
| ××”×• ×”×˜×™×¤×•×œ ×”×¨××©×•× ×™ ×‘×“×™××•× ×—×™×¦×•× ×™? | ×œ×—×¥ ×™×©×™×¨ | ×—×•×¡× ×¢×•×¨×§×™× | ×¢×™×¨×•×™ × ×•×–×œ×™× | ×ª×¨×•×¤×•×ª | 1 | trauma | Easy |
| ××™×š ××˜×¤×œ×™× ×‘×©×‘×¨ ×¤×ª×•×—? | ×›×™×¡×•×™ ×¡×˜×¨×™×œ×™ ×•×œ×—×¥ | ×¨×§ ×§×™×‘×•×¢ | ×¨×§ ×—×‘×™×©×” | ×œ× ×œ×˜×¤×œ | 1 | trauma | Medium |
| ××”×• ×¡×™××Ÿ ×œ××¦×‘ ×”×œ×? | ×“×•×¤×§ ××”×™×¨ ×•×—×œ×© | ×—×•× ×’×‘×•×” | ×›××‘ ×¨××© | ×©×™×¢×•×œ | 1 | trauma | Hard |
| ××”×™ × ×§×•×“×ª ×¢×™×§×•×œ ×‘××¤×•×œ×ª? | ××§×•× ×‘×˜×•×— ××”×§×¨×™×¡×” | ××§×•× ××¡×•×›×Ÿ | ×›× ×™×¡×” ×œ××¤×•×œ×ª | ×™×¦×™××” ××”××¤×•×œ×ª | 1 | rescue | Easy |
| ××™×š ××–×”×™× ×—×œ×œ ×‘×˜×•×Ÿ? | ×“×¤×™×§×•×ª ×•×”×§×©×‘×” | ×¨××™×™×” | ×¨×™×— | ××™×©×•×© | 1 | rescue | Medium |

**ğŸ“Œ ×˜×™×¤:** ×”×•×¡×£ ×œ×¤×—×•×ª 40-50 ×©××œ×•×ª ××›×œ × ×•×©× ×•×§×•×©×™ ×›×“×™ ×©×ª×”×™×” ××’×•×•×Ÿ.

---

## ğŸ’» ×©×œ×‘ 4: ×™×¦×™×¨×ª Apps Script

### 4.1 ×¤×ª×™×—×ª Apps Script
1. ×‘-Google Sheet, ×œ×—×¥ ×¢×œ **Extensions** â†’ **Apps Script**
2. ××—×§ ××ª ×”×§×•×“ ×”×§×™×™×

### 4.2 ×”×“×‘×§ ××ª ×”×§×•×“ ×”×–×”:

```javascript
function doGet(e) {
  const sheetName = e.parameter.sheet || 'exam_hovesh_1'; // ×‘×¨×™×¨×ª ××—×“×œ
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const ws = ss.getSheetByName(sheetName);

  if (!ws) {
    return ContentService.createTextOutput(
      JSON.stringify({
        success: false,
        error: 'Sheet not found: ' + sheetName
      })
    ).setMimeType(ContentService.MimeType.JSON);
  }

  const data = ws.getDataRange().getValues();
  const headers = data[0]; // ×©×•×¨×ª ×›×•×ª×¨×•×ª
  const rows = data.slice(1); // ×›×œ ×”×©××œ×•×ª

  const questions = rows
    .filter(row => row[0] && row[0].toString().trim() !== '') // ×¨×§ ×©××œ×•×ª ×œ× ×¨×™×§×•×ª
    .map(row => {
      let obj = {};
      headers.forEach((header, index) => {
        obj[header] = row[index];
      });
      return obj;
    });

  return ContentService.createTextOutput(
    JSON.stringify({
      success: true,
      questions: questions,
      total: questions.length
    })
  ).setMimeType(ContentService.MimeType.JSON);
}
```

### 4.3 ×¤×¨×™×¡×ª Apps Script
1. ×©××•×¨ ××ª ×”×§×•×“ (Ctrl+S)
2. ×œ×—×¥ ×¢×œ **Deploy** â†’ **New deployment**
3. ×œ×—×¥ ×¢×œ âš™ï¸ ×œ×™×“ "Select type" ×•×‘×—×¨ **Web app**
4. ×”×’×“×¨×•×ª:
   - **Execute as:** Me
   - **Who has access:** Anyone
5. ×œ×—×¥ **Deploy**
6. **×”×¢×ª×§ ××ª ×”-Web app URL** ×©×§×™×‘×œ×ª

**×“×•×’××” ×œ-URL:**
```
https://script.google.com/macros/s/AKfycby.../exec
```

---

## ğŸ”— ×©×œ×‘ 5: ×¢×“×›×•×Ÿ ×§×‘×¦×™ ×”××‘×—× ×™×

×¢×›×©×™×• ×ª×¦×˜×¨×š ×œ×¢×“×›×Ÿ 4 ×§×‘×¦×™ HTML ×¢× ×”-URL ×©×§×™×‘×œ×ª:

1. **exam-hovesh-1.html** (×©×•×¨×” ~30):
```javascript
const SCRIPT_URL = 'YOUR_APPS_SCRIPT_URL_HERE?sheet=exam_hovesh_1';
```

2. **exam-hovesh-2.html** (×©×•×¨×” ~30):
```javascript
const SCRIPT_URL = 'YOUR_APPS_SCRIPT_URL_HERE?sheet=exam_metav_1';
```

3. **exam-metav-1.html** (×©×•×¨×” ~30):
```javascript
const SCRIPT_URL = 'YOUR_APPS_SCRIPT_URL_HERE?sheet=exam_hovesh_1';
```

4. **exam-metav-2.html** (×©×•×¨×” ~30):
```javascript
const SCRIPT_URL = 'YOUR_APPS_SCRIPT_URL_HERE?sheet=exam_metav_1';
```

**âš ï¸ ×©×™× ×œ×‘:** ××‘×—× ×™ ×¤×ª×™×—×” (hovesh-1, metav-1) ×©×•××‘×™× ×-`exam_hovesh_1`
×•××‘×—× ×™ ×¡×™×•× (hovesh-2, metav-2) ×©×•××‘×™× ×-`exam_metav_1`

---

## ğŸ“Š ×”×ª×¤×œ×’×•×ª ×”×©××œ×•×ª

### ××‘×—× ×™ ×¤×ª×™×—×” (hovesh-1, metav-1):
- **70% ×˜×¨××•××”:**
  - 20% Easy (3.5 â†’ **4 ×©××œ×•×ª**)
  - 50% Medium (8.75 â†’ **9 ×©××œ×•×ª**)
  - 30% Hard (5.25 â†’ **5 ×©××œ×•×ª**)
- **30% ×—×™×œ×•×¥:**
  - 50% Easy (3.75 â†’ **4 ×©××œ×•×ª**)
  - 35% Medium (2.625 â†’ **3 ×©××œ×•×ª**)
  - 15% Hard (1.125 â†’ **1 ×©××œ×”**)

**×¡×”"×›: 25 ×©××œ×•×ª**

### ××‘×—× ×™ ×¡×™×•× (hovesh-2, metav-2):
- **40% ×˜×¨××•××”:**
  - 20% Easy (2 â†’ **2 ×©××œ×•×ª**)
  - 55% Medium (5.5 â†’ **6 ×©××œ×•×ª**)
  - 25% Hard (2.5 â†’ **2 ×©××œ×•×ª**)
- **60% ×—×™×œ×•×¥:**
  - 10% Easy (1.5 â†’ **2 ×©××œ×•×ª**)
  - 60% Medium (9 â†’ **9 ×©××œ×•×ª**)
  - 25% Hard (3.75 â†’ **4 ×©××œ×•×ª**)

**×¡×”"×›: 25 ×©××œ×•×ª**

---

## âœ… ×‘×“×™×§×”

1. ×¤×ª×— ××—×“ ××§×‘×¦×™ ×”××‘×—× ×™× ×‘×“×¤×“×¤×Ÿ
2. ×¤×ª×— **Console** (F12)
3. ×××•×¨ ×œ×¨××•×ª:
   ```
   âœ… × ×˜×¢× ×• 25 ×©××œ×•×ª ××ª×•×š 50 ×©××œ×•×ª ×–××™× ×•×ª
   ğŸ“Š ×”×ª×¤×œ×’×•×ª: Trauma: 17 | Rescue: 8
   ```
4. ×›×œ ×©××œ×” ×ª×¦×™×’ tag **E** | **M** | **H** ×‘×¦×“ ×™××™×Ÿ

---

## ğŸ”§ ×¤×ª×¨×•×Ÿ ×ª×§×œ×•×ª

### "Sheet not found"
- ×•×“× ×©×”×©× ×©×œ ×”×’×œ×™×•×Ÿ ×‘×“×™×•×§ `exam_hovesh_1` ××• `exam_metav_1`

### "×œ× × ××¦××• ××¡×¤×™×§ ×©××œ×•×ª"
- ×¦×¨×™×š ×œ×¤×—×•×ª 40-50 ×©××œ×•×ª ××›×œ ×¡×•×’ (trauma Easy, trauma Medium, ×•×›×•')

### ×”×©××œ×•×ª ×œ× ××ª×¢×¨×‘×‘×•×ª
- ×–×” ×ª×§×™×Ÿ! ×”××¢×¨×›×ª ××¢×¨×‘×‘×ª ××ª ×”×©××œ×•×ª ××•×˜×•××˜×™×ª ×‘×›×œ ×˜×¢×™× ×”

### Tag ×œ× ××•×¦×’
- ×‘×“×•×§ ×‘-Console ×©×”×©××œ×•×ª ××›×™×œ×•×ª `difficulty: "Easy"/"Medium"/"Hard"`

---

**× ×•×¦×¨ ×¢×‘×•×¨ ××“×•×¨ ×¨×¤×•××”** ğŸ©º
